## explain/desc

#### 语法

> explain + SQL 语句（select 语句）
>
> desc + SQL 语句（select 语句）
> 
>> 


```sql
## 例如： explain select * from t3 where id=1;
+----+-------------+-------+-------+-------------------+---------+---------+-------+------+-------+
| id | select_type | table | type  | possible_keys     | key     | key_len | ref   | rows | Extra |
+----+-------------+-------+-------+-------------------+---------+---------+-------+------+-------+
```

#### explain执行计划中包含的信息如下：
- id:  查询序列号
- select_type: 查询类型
- table: 表名或者别名
- partitions: 匹配的分区
- type: 访问类型
- possible_keys: 可能用到的索引
- key: 实际用到的索引
- key_len: 索引长度
- ref: 与索引比较的列
- rows: 估算的行数
- filtered: 按表条件筛选的行百分比
- Extra: 额外信息

#### `select_type` 常见类型及其含义
- SIMPLE：不包含子查询或者 UNION 操作的查询
- PRIMARY：查询中如果包含任何子查询，那么最外层的查询则被标记为 PRIMARY
- SUBQUERY：子查询中第一个 SELECT
- DEPENDENT SUBQUERY：子查询中的第一个 SELECT，取决于外部查询
- UNION：UNION 操作的第二个或者之后的查询
- DEPENDENT UNION：UNION 操作的第二个或者之后的查询,取决于外部查询
- UNION RESULT：UNION 产生的结果集
- DERIVED：出现在 FROM 字句中的子查询

#### `type`常见类型及其含义
- system：这是 const 类型的一个特例，只会出现在待查询的表只有一行数据的情况下
- consts：常出现在主键或唯一索引与常量值进行比较的场景下，此时查询性能是最优的
- eq_ref：当连接使用的是完整的索引并且是 PRIMARY KEY 或 UNIQUE NOT NULL INDEX 时使用它
- ref：当连接使用的是前缀索引或连接条件不是 PRIMARY KEY 或 UNIQUE INDEX 时则使用它
- ref_or_null：类似于 ref 类型的查询，但是附加了对 NULL 值列的查询
- index_merge：该联接类型表示使用了索引进行合并优化
- range：使用索引进行范围扫描，常见于 between、> 、< 这样的查询条件
- index：索引连接类型与 ALL 相同，只是扫描的是索引树，通常出现在索引是该查询的覆盖索引的情况
- ALL：全表扫描，效率最差的查找方式

!> 从下到上，性能从差到好


#### Extra列

Extra 列主要用于显示额外的信息，常见信息及其含义如下：

- Using where ：MySQL 服务器会在存储引擎检索行后再进行过滤
- Using filesort：通常出现在 GROUP BY 或 ORDER BY 语句中，且排序或分组没有基于索引，此时需要使用文件在内存中进行排序，因为使用索引排序的性能好于使用文件排序，所以出现这种情况可以考虑通过添加索引进行优化
- Using index：使用了覆盖索引进行查询，此时不需要访问表，从索引中就可以获取到所需的全部数据
- Using index condition：查找使用了索引，但是需要回表查询数据
- Using temporary：表示需要使用临时表来处理查询，常出现在 GROUP BY 或 ORDER BY 语句中


当一条sql语句提交给mysql数据库进行查询的时候需要经历以下几步

1. 先在where解析这一步把当前的查询语句中的查询条件分解成每一个独立的条件单元
2. mysql会自动将sql拆分重组
3. 然后where条件会在B-tree index这部分进行索引匹配，如果命中索引，就会定位到指定的table records位置。如果没有命中，则只能采用全部扫描的方式
4、根据当前查询字段返回对应的数据值
